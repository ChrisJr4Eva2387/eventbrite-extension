function EventsList(){"use strict";null!==____Class0&&____Class0.apply(this,arguments)}function Header(){"use strict";null!==____Class1&&____Class1.apply(this,arguments)}function App(a){"use strict";____Class2.call(this,a),this.state={events:a.events||[],location:a.location,radius:a.radius,popularEvents:a.popularEvents||!1,nextWeekendEvents:a.nextWeekendEvents||!1,marathonEvents:a.marathonEvents||!1,likedEvents:a.likedEvents||[],showLiked:!1}}var CONSTANTS={TOKEN:"DB76SJDUSQFFHVNSQC6Y",API_ENDPOINT:"https://www.eventbriteapi.com/v3/events/search/",POSTDATA_DATE_FORMAT:"YYYY-MM-DDTHH:mm:ss[Z]",EVENT_DISPLAY_DATE_FORMAT:"ddd, MMM D h:mm A"},storage=chrome.storage.local,localData={},mountNode=document.getElementById("app"),ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,____Class0=React.Component;for(var ____Class0____Key in ____Class0)____Class0.hasOwnProperty(____Class0____Key)&&(EventsList[____Class0____Key]=____Class0[____Class0____Key]);var ____SuperProtoOf____Class0=null===____Class0?null:____Class0.prototype;EventsList.prototype=Object.create(____SuperProtoOf____Class0),EventsList.prototype.constructor=EventsList,EventsList.__superConstructor__=____Class0,Object.defineProperty(EventsList.prototype,"handleClick",{writable:!0,configurable:!0,value:function(a){"use strict";a.preventDefault(),chrome.tabs.create({url:$(a.currentTarget).attr("href")})}}),Object.defineProperty(EventsList.prototype,"handleLikeClick",{writable:!0,configurable:!0,value:function(a,b){"use strict";this.props.onEventLike(a),$(b.currentTarget).toggleClass("liked"),b.stopPropagation()}}),Object.defineProperty(EventsList.prototype,"render",{writable:!0,configurable:!0,value:function(){"use strict";var a,b=this.props.showLiked?this.props.likedEvents:this.props.events;if(0==b.length&&""!=$.trim(this.props.location))return React.createElement("div",{className:"no-events-found"},React.createElement("span",null,"Whoops! No events found."));if(this.props.showLiked)a=b;else if(this.props.marathonEvents){b=b.sort(function(a,b){return Math.floor(new Date(a.end.utc).getTime()/1e3)-Math.floor(new Date(b.end.utc).getTime()/1e3)}),a=[b[0]];for(var c=1;c<b.length;c++){var d=Math.floor(new Date(b[c].start.utc).getTime()/1e3),e=Math.floor(new Date(b[a.length-1].end.utc).getTime()/1e3);e>d&&a.push(b[c])}}else a=b;var b=a.map(function(a){var b=moment(a.start.local).format(CONSTANTS.EVENT_DISPLAY_DATE_FORMAT),c=(moment(a.end.local).format(CONSTANTS.EVENT_DISPLAY_DATE_FORMAT),[]);if(a.venue.address.city&&c.push(a.venue.address.city),a.venue.address.region&&c.push(a.venue.address.region),a.hasOwnProperty("logo_url"))var d={backgroundImage:"url("+(a.logo_url?a.logo_url:"")+")"};else var d={backgroundImage:"url("+(a.logo?a.logo.url:"")+")"};var e=this.props.likedEvents.filter(function(b){return b.id==a.id}).length?"liked":"";return React.createElement("li",{key:a.id,className:"event-container"},React.createElement("a",{href:a.url,onClick:this.handleClick.bind(this)},React.createElement("div",{className:"event"},React.createElement("div",{className:"image",style:d,"data-adaptive-background":"1","data-ab-css-background":"1"}),React.createElement("div",{className:"body"},React.createElement("span",{className:"title"},a.name.text),React.createElement("span",{className:"like "+e,onClick:this.handleLikeClick.bind(this,a)}),React.createElement("span",{className:"organizer"},a.organizer.name),React.createElement("span",{className:"date"},b),c.length>0?React.createElement("span",{className:"address"},c.join(", ")):""))))},this);return React.createElement("div",null,React.createElement(ReactCSSTransitionGroup,{component:"ul",className:"events-list",transitionName:"events-list-transition"},b))}});var ____Class1=React.Component;for(var ____Class1____Key in ____Class1)____Class1.hasOwnProperty(____Class1____Key)&&(Header[____Class1____Key]=____Class1[____Class1____Key]);var ____SuperProtoOf____Class1=null===____Class1?null:____Class1.prototype;Header.prototype=Object.create(____SuperProtoOf____Class1),Header.prototype.constructor=Header,Header.__superConstructor__=____Class1,Object.defineProperty(Header.prototype,"componentDidMount",{writable:!0,configurable:!0,value:function(){"use strict";this.$settingsDropdown=$(React.findDOMNode(this.refs.settingsDropdown))}}),Object.defineProperty(Header.prototype,"settingsClickHandler",{writable:!0,configurable:!0,value:function(){"use strict";this.$settingsDropdown.toggle()}}),Object.defineProperty(Header.prototype,"showLikedEventsClickHandler",{writable:!0,configurable:!0,value:function(){"use strict";this.$settingsDropdown.hide(),this.props.onShowLikedEvents()}}),Object.defineProperty(Header.prototype,"clearStorageClickHandler",{writable:!0,configurable:!0,value:function(){"use strict";this.$settingsDropdown.hide(),this.props.onClearStorageEvent()}}),Object.defineProperty(Header.prototype,"render",{writable:!0,configurable:!0,value:function(){"use strict";return React.createElement("div",{id:"logo-container"},React.createElement("div",{id:"logo"}),React.createElement("div",{id:"settings"},React.createElement("i",{className:"icon",onClick:this.settingsClickHandler.bind(this)}),React.createElement("div",{className:"settings-dropdown",ref:"settingsDropdown"},React.createElement("ul",null,React.createElement("li",{onClick:this.showLikedEventsClickHandler.bind(this)},"Show liked"),React.createElement("li",{onClick:this.clearStorageClickHandler.bind(this)},"Clear storage")))))}});var ____Class2=React.Component;for(var ____Class2____Key in ____Class2)____Class2.hasOwnProperty(____Class2____Key)&&(App[____Class2____Key]=____Class2[____Class2____Key]);var ____SuperProtoOf____Class2=null===____Class2?null:____Class2.prototype;App.prototype=Object.create(____SuperProtoOf____Class2),App.prototype.constructor=App,App.__superConstructor__=____Class2,Object.defineProperty(App.prototype,"getData",{writable:!0,configurable:!0,value:function(a,b,c,d,e){"use strict";var f=this,g={"location.address":a,"location.within":b+"mi",token:CONSTANTS.TOKEN};if(c&&(g.popular="on"),d){var h=moment().add(1,"weeks").endOf("isoWeek").subtract(2,"day").add(1,"second"),i=moment().add(1,"weeks").endOf("isoWeek");g["start_date.range_start"]=h.format(CONSTANTS.POSTDATA_DATE_FORMAT),g["start_date.range_end"]=i.format(CONSTANTS.POSTDATA_DATE_FORMAT)}$.ajax({url:CONSTANTS.API_ENDPOINT,type:"GET",dataType:"JSON",data:g,success:function(g){({location:a,locationRadius:b,popularEvents:c,nextWeekendEvents:d,marathonEvents:e,locationData:g.events.map(function(a){return{id:a.id,start:a.start,end:a.end,url:a.url,venue:a.venue,logo:a.logo,name:a.name,organizer:a.organizer}})});storage.clear(),f.setState({events:g.events,location:a,radius:b,popularEvents:c,nextWeekendEvents:d,marathonEvents:e}),f.hideLoading()}})}}),Object.defineProperty(App.prototype,"shouldComponentUpdate",{writable:!0,configurable:!0,value:function(a,b){"use strict";var c=b.hasOwnProperty("silent");return c&&delete b.silent,b.hasOwnProperty("silent")?!b.silent:!0}}),Object.defineProperty(App.prototype,"componentDidMount",{writable:!0,configurable:!0,value:function(){"use strict";var a=this;this.searchInput=this.refs.searchInput.getDOMNode(),this.searchRadiusInput=this.refs.searchRadiusInput.getDOMNode(),this.popularEvents=this.refs.popularEvents.getDOMNode(),this.nextWeekendEvents=this.refs.nextWeekendEvents.getDOMNode(),this.marathonEvents=this.refs.marathonEvents.getDOMNode(),this.service=new google.maps.places.AutocompleteService,$(this.searchInput).typeahead({highlight:!0},{displayKey:"prediction",source:function(b,c){a.service.getPlacePredictions({input:b},function(a,b){b==google.maps.places.PlacesServiceStatus.OK&&c($.map(a,function(a){return{prediction:a.description}}))})}}).on("typeahead:selected",function(b,c){a.showLoading(),a.getData(c.prediction,a.searchRadiusInput.value,a.popularEvents.checked,a.nextWeekendEvents.checked,a.marathonEvents.checked)}).on("focus",function(){$(".location-marker").css("opacity",1)}).on("focusout",function(){$(".location-marker").css("opacity",0)}),this.hideLoading(),$("body").on("click",function(a){$(a.target).hasClass("settings-dropdown")||$(".settings-dropdown").hide()})}}),Object.defineProperty(App.prototype,"showLikedEventsClickHandler",{writable:!0,configurable:!0,value:function(){"use strict";this.setState({showLiked:!0})}}),Object.defineProperty(App.prototype,"showAllEvents",{writable:!0,configurable:!0,value:function(){"use strict";this.setState({showLiked:!1})}}),Object.defineProperty(App.prototype,"clearStorageEventClickHandler",{writable:!0,configurable:!0,value:function(){"use strict";storage.set({eventbritearoundme:""}),this.setState({events:[],location:null,radius:null,popularEvents:!1,nextWeekendEvents:!1,marathonEvents:!1,likedEvents:[],showLiked:!1}),$(React.findDOMNode(this.refs.searchInput)).typeahead("val","")}}),Object.defineProperty(App.prototype,"hideLoading",{writable:!0,configurable:!0,value:function(){"use strict";$(this.refs.eventsListContainer.getDOMNode()).removeClass("loading"),$(this.refs.loader.getDOMNode()).hide()}}),Object.defineProperty(App.prototype,"showLoading",{writable:!0,configurable:!0,value:function(){"use strict";$(this.refs.eventsListContainer.getDOMNode()).addClass("loading"),$(this.refs.loader.getDOMNode()).show()}}),Object.defineProperty(App.prototype,"searchRadiusChangeHandler",{writable:!0,configurable:!0,value:function(a){"use strict";var b=this.searchInput.value;""!=$.trim(b)&&(this.showLoading(),this.getData(b,a.target.value,this.popularEvents.checked,this.nextWeekendEvents.checked,this.marathonEvents.checked))}}),Object.defineProperty(App.prototype,"eventLikeHandler",{writable:!0,configurable:!0,value:function(a){"use strict";var b=this.state.likedEvents,c=this,d=b.filter(function(b){return b.id==a.id});d.length?b.splice(b.indexOf(d[0]),1):b.push(a),this.setState({likedEvents:b,silent:!0},function(){storage.set({eventbritearoundme:JSON.stringify(c.state)})})}}),Object.defineProperty(App.prototype,"optionsHandler",{writable:!0,configurable:!0,value:function(a){"use strict";this.setState({popularEvents:this.popularEvents.checked,nextWeekendEvents:this.nextWeekendEvents.checked,marathonEvents:this.marathonEvents.checked});var b=this.searchInput.value;if(""!=$.trim(b)){this.showLoading();var c=$(a.target).attr("name");"popular-events"==c?this.getData(this.searchInput.value,this.searchRadiusInput.value,this.popularEvents.checked,this.nextWeekendEvents.checked,this.marathonEvents.checked):"next-weekend-events"==c?this.getData(this.searchInput.value,this.searchRadiusInput.value,this.popularEvents.checked,this.nextWeekendEvents.checked,this.marathonEvents.checked):this.getData(this.searchInput.value,this.searchRadiusInput.value,this.popularEvents.checked,this.nextWeekendEvents.checked,this.marathonEvents.checked)}}}),Object.defineProperty(App.prototype,"eventOptionsStyle",{writable:!0,configurable:!0,value:function(a){"use strict";var b=this.state.showLiked;return"!"==a&&(b=!b),{display:b?"none":""}}}),Object.defineProperty(App.prototype,"render",{writable:!0,configurable:!0,value:function(){"use strict";var a=this.state.location,b=this.state.radius,c=this.state.popularEvents,d=this.state.nextWeekendEvents,e=this.state.marathonEvents;return React.createElement("div",null,React.createElement(Header,{onShowLikedEvents:this.showLikedEventsClickHandler.bind(this),onClearStorageEvent:this.clearStorageEventClickHandler.bind(this)}),React.createElement("div",{className:"loader",ref:"loader"},React.createElement("img",{src:"../img/icons/48x48.png"})),React.createElement("div",{className:"search-box"},React.createElement("div",{className:"block-header"},React.createElement("span",{className:"title"},"Popular events within",React.createElement("select",{className:"search-radius-input",ref:"searchRadiusInput",onChange:this.searchRadiusChangeHandler.bind(this),defaultValue:b},React.createElement("option",{value:"10"},"10"),React.createElement("option",{value:"25"},"25"),React.createElement("option",{value:"50"},"50")),"miles around ")),React.createElement("div",{className:"location-input"},React.createElement("span",{className:"location-marker"}),React.createElement("input",{autoFocus:!0,type:"text",ref:"searchInput",className:"search-input",placeholder:"Enter your location here",defaultValue:a}))),React.createElement("div",{className:"event-options",style:this.eventOptionsStyle()},React.createElement("label",null,React.createElement("input",{type:"checkbox",value:"true",ref:"popularEvents",name:"popular-events",checked:""==c?!1:!0,onChange:this.optionsHandler.bind(this)}," Popular ")),React.createElement("label",null,React.createElement("input",{type:"checkbox",value:"true",ref:"nextWeekendEvents",name:"next-weekend-events",checked:""==d?!1:!0,onChange:this.optionsHandler.bind(this)}," Next Weekend ")),React.createElement("label",null,React.createElement("input",{type:"checkbox",value:"true",ref:"marathonEvents",name:"marathon-events",checked:""==e?!1:!0,onChange:this.optionsHandler.bind(this)}," Marathon "))),React.createElement("div",{className:"event-options",style:this.eventOptionsStyle("!")},React.createElement("a",{href:"#",onClick:this.showAllEvents.bind(this)}," Show all events ")),React.createElement("div",{className:"events-list-container",ref:"eventsListContainer"},React.createElement(EventsList,React.__spread({},this.state,{onEventLike:this.eventLikeHandler.bind(this)}))))}}),storage.get("eventbritearoundme",function(a){void 0!==a.eventbritearoundme&&(localData=""!=a.eventbritearoundme?JSON.parse(a.eventbritearoundme):{}),React.render(React.createElement(App,React.__spread({},localData)),mountNode)});